<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"/>
  <title>Fitness Zone</title>
  <link rel="stylesheet" href="/CSS/fintesszone.css">
  <link rel="stylesheet" href="/CSS/fitness.css">
  <link rel="icon" href="/Images/logo-transparent.png">
  <script src="/JavaScript/fitness.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>

  <div class="container-fluid">
    <div class="row">
      <div class="col-md-3">
        <div class="container mt-4 custom-container">
          <button class="btn btn-info btn-lg mb-3" onclick="window.location.href='home.html'">Get back</button>
          <form>
            <div class="form-group">
              <label for="exercise" style="color: white;">Choose the exercise:</label>
              <input list="exercises" name="exercise" id="exercise" class="form-control" pattern=".*" autocomplete="off" oninput="updateList()">
              <datalist id="exercises">
                <option value="Chest">
                <option value="Back">
                <option value="Shoulder">
                <option value="Leg">
                <option value="Abdominal">
                <option value="Arm">
                <option value="Full-Body">
              </datalist>
            </div>
          </form>

          <div id="exercise-list-container">
            <ul id="defaultList" class="sortable-list">
            <li class="item" draggable="true">
              <div class="details">
                <span>Exercise 1</span>
              </div>
              <i class="uil uil-draggabledots"></i>
            </li>
            <li class="item" draggable="true">
              <div class="details">
                <span>Exercise 2</span>
              </div>
              <i class="uil uil-draggabledots"></i>
            </li>
            <li class="item" draggable="true">
              <div class="details">
                <span>Exercise 3</span>
              </div>
              <i class="uil uil-draggabledots"></i>
            </li>
            <li class="item" draggable="true">
              <div class="details">
                <span>Exercise 4</span>
              </div>
              <i class="uil uil-draggabledots"></i>
            </li>
            <li class="item" draggable="true">
              <div class="details">
                <span>Exercise 5</span>
              </div>
              <i class="uil uil-draggabledots"></i>
            </li>
            <li class="item" draggable="true">
              <div class="details">
                <span>Exercise 6</span>
              </div>
              <i class="uil uil-draggabledots"></i>
            </li>
          </ul>
        </div>
        <button class="btn btn-primary" id="removeButton">Exercise Done</button>
        </div>
      </div>
  
  <div class="d-flex flex-column justify-content-center" style="margin-left:10% ;">
  <!-- <div class="container text-center" style="background-color: #0f959cb9; color: white;">
    <h1 style="font-size: 10vh;">SuperNova</h1>
    <h2>Fitness Zone</h2>
  </div> -->
  <div class="container mt-10">
    <div class="container mt-5 timer-container flex-row">
      <div class="row align-items-center justify-content-center">
        <div class="counter text-center">
          <button class="btn custom-btn increase" data-target="hour-2"><span class="material-symbols-outlined">expand_less</span></button>
          <h1 id="hour-2">0</h1>
          <button class="btn custom-btn decrease" data-target="hour-2"><span class="material-symbols-outlined">expand_more</span></button>
        </div>
        <div class="counter text-center">
          <button class="btn custom-btn increase" data-target="hour-1"><span class="material-symbols-outlined">expand_less</span></button>
          <h1 id="hour-1">0</h1>
          <button class="btn custom-btn decrease" data-target="hour-1"><span class="material-symbols-outlined">expand_more</span></button>
        </div>
        <div class="counter" id="semi-colon">
          <h1>:</h1>
        </div>
        <div class="counter text-center">
          <button class="btn custom-btn increase" data-target="minute-2"><span class="material-symbols-outlined">expand_less</span></button>
          <h1 id="minute-2">0</h1>
          <button class="btn custom-btn decrease" data-target="minute-2"><span class="material-symbols-outlined">expand_more</span></button>
        </div>
        <div class="counter text-center">
          <button class="btn custom-btn increase" data-target="minute-1"><span class="material-symbols-outlined">expand_less</span></button>
          <h1 id="minute-1">0</h1>
          <button class="btn custom-btn decrease" data-target="minute-1"><span class="material-symbols-outlined">expand_more</span></button>
        </div>
        <div class="counter" id="semi-colon">
          <h1>:</h1>
        </div>
        <div class="counter text-center">
          <button class="btn custom-btn increase" data-target="second-2"><span class="material-symbols-outlined">expand_less</span></button>
          <h1 id="second-2">0</h1>
          <button class="btn custom-btn decrease" data-target="second-2"><span class="material-symbols-outlined">expand_more</span></button>
        </div>
        <div class="counter text-center" id="second">
          <button class="btn custom-btn increase" data-target="second-1"><span class="material-symbols-outlined">expand_less</span></button>
          <h1 id="second-1">0</h1>
          <button class="btn custom-btn decrease" data-target="second-1"><span class="material-symbols-outlined">expand_more</span></button>
        </div>
      </div>
      <div class="row justify-content-center mt-4">
        <div class="col-3 text-center">
          <button class="btn btn-primary btn-lg" id="startButton">Start</button>
        </div>
        <div class="col-3 text-center">
          <button class="btn btn-warning btn-lg" id="stopButton">Stop</button>
        </div>
        <div class="col-3 text-center"> 
          <button class="btn btn-danger btn-lg" id="resetButton">Reset</button>
        </div>
      </div>
    </div>
  </div>
  <div class="custom-container-right">
    <iframe id="exercise-video" src="https://www.youtube.com/embed/Q4c-2BhKvBo" frameborder="0" height="100%" width="100%"></iframe>
  </div>
  


  <script>

    // const exercises = [
    //   {
    //     ID : 'Chest-1',
    //     link : ''
    //   }
    // ]

    const exerciseVideoMap = new Map([
      ["Default","Q4c-2BhKvBo"],
      ["Bench Press", "0cXAp6WhSj4"],
      ["Push-ups", "y7PBQ2fYbxY"],
      ["Chest Flyes", "Jz7oEmzhnfE"],
      ["Dumbbell Press", "3zK-QobOkHg"],
      ["Incline Bench Press", "MRmeUet5VUw"],
      ["Cable Crossover", "tGXIQR89-JE"],

      ["Deadlifts", "vfKwjT5-86k"],
      ["Pull-ups", "dvG8B2OjfWk"],
      ["Bent-over Rows", "Nqh7q3zDCoQ"],
      ["Lat Pulldowns", "77bPLrsMwiQ"],
      ["T-Bar Rows", "8c23NBbwLBc"],
      ["Face Pulls", "LJN-sT_6OYY"],

      ["Overhead Press", "dyv6g4xBFGU"],
      ["Lateral Raises", "G-piLwLu0d4"],
      ["Front Raises", "yHx8wPv4RPo"],
      ["Shrugs", "kG4qXCYvITg"],
      ["Upright Rows", "AWsGWt-VMl8"],
      ["Arnold Press", "6K_N9AGhItQ"],

      ["Squats", "gslEzVggur8"],
      ["Lunges", "LCWWq3Lx2Sk"],
      ["Deadlifts", "vfKwjT5-86k"],
      ["Leg Press", "obqVU1u3Bfk"],
      ["Leg Extensions", "fP6uMgfwqOA"],
      ["Calf Raises", "OscsK8RMelQ"],

      ["Crunches", "ZKw4t23ERuw"],
      ["Planks", "v25dawSzRTM"],
      ["Leg Raises", "6mDUQZTdrtM"],
      ["Russian Twists", "BA-uP_-bVE8"],
      ["Bicycle Crunches", "CakPX7X-mSw"],
      ["Mountain Climbers", "9yyKVy8OWnA"],

      ["Bicep Curls", "2jpteC44QKg"],
      ["Tricep Dips", "Goy5WkxbAi0"],
      ["Hammer Curls", "ZzJs4BLnhCw"],
      ["Tricep Kickbacks", "3Bv1n7-DN7c"],
      ["Preacher Curls", "Htw-s61mOw0"],
      ["Skull Crushers", "zR9gty7LUxE"],

      ["Burpees", "zlYA1SENYG4"],
      ["Clean and Jerk", "sqTDWYlVgBQ"],
      ["Thrusters", "RqRX_PfMJ5A"],
      ["Kettlebell Swings", "SR_4kUbkEaw"],
      ["Turkish Get-ups", "-dfk79o6iHI"],
      ["Medicine Ball Slams", "cgKqNn90MEo"],
    ]);

    function updateIframe(videoId) {
      if($('.sortable-list li:first-child')){
        var iframeSrc = "https://www.youtube.com/embed/" + videoId;
        $('#exercise-video').attr('src', iframeSrc);
      }
      
    }

    function checkExercise() {
      if ($('.sortable-list li:first-child').text() !== ""){
        var text = $('.sortable-list li:first-child').text()
        var exerciseID = $('.sortable-list li:first-child').attr('data-video-id')
        if (text.includes(" - Active")) {} 
        else {
          $('.sortable-list li:first-child').text(text+" - Active")
          if(text.includes("Exercise")){
            var videoId = exerciseVideoMap.get("Default");
            updateIframe(videoId);
          }
          else if(text !== ""){
            var videoId = exerciseVideoMap.get(exerciseID);
            updateIframe(videoId);
          }
          else{
            var videoId = exerciseVideoMap.get("Default");
            updateIframe(videoId);
          }
        }
        for (var i = 2 ; i < 7 ; i++){
          var text2 = $('.sortable-list li:nth-child('+i+')').text()
          $('.sortable-list li:nth-child('+i+')').text(text2.replace(' - Active',''))
        }
      }
    }

    setInterval(checkExercise, 500);

    $(document).ready(function () {
      
        $("#startButton").click(function () {
            $("#stopButton").stop().animate({
                fontSize: "20px", 
            }, 500); 
            
            $(this).animate({
                fontSize: "30px", 
            }, 500); 
        });

        $("#stopButton").click(function () {
            $("#startButton").stop().animate({
                fontSize: "20px",
            }, 500);

            $(this).animate({
                fontSize: "30px",
            }, 500);
        });

        $("#resetButton").click(function () {
            $("#startButton").stop().animate({
                fontSize: "20px", 
            }, 500); 
            $("#stopButton").stop().animate({
                fontSize: "20px",
            }, 500);
        });

    });

    function myCallback() {
      console.log('Callback executed!');
      console.log('1 second at a time!')
    }

    setTimeout(function() {
      // Kjo pjesë e kodit do të ekzekutohet pas 2000 milisecondave (2 sekonda)
      console.log('Kjo ekzekutohet pas 2 sekondave.');
    }, 2000);

    function disableButtons(disabled) {
        const buttons = document.querySelectorAll('.increase, .decrease');
        buttons.forEach(button => {
          button.disabled = disabled;
        });
    }

    function updateNumber(targetId, operation, limit) {
      const targetElement = document.getElementById(targetId);
      let currentNumber = parseInt(targetElement.textContent);

      currentNumber = (currentNumber + (operation === 'increase' ? 1 : -1) + limit + 1) % (limit + 1);

      targetElement.textContent = currentNumber;
    }

    function updateClockWithCallback() {
      var hour2 = document.getElementById('hour-2').textContent
      var hour1 = document.getElementById('hour-1').textContent
      var minute2 = document.getElementById('minute-2').textContent
      var minute1 = document.getElementById('minute-1').textContent
      var second2 = document.getElementById('second-2').textContent
      var second1 = document.getElementById('second-1').textContent

      var hours = parseInt(hour2+hour1);
      var minutes = parseInt(minute2+minute1);
      var seconds = parseInt(second2+second1);

      let totalSeconds = hours * 3600 + minutes * 60 + seconds;

      totalSeconds--;

      hours = Math.floor(totalSeconds / 3600);
      minutes = Math.floor((totalSeconds % 3600) / 60);
      seconds = totalSeconds % 60;

      if (totalSeconds === 0 || totalSeconds < 0) {
            console.log("Timer completed!");
            $("#startButton").stop().animate({
                fontSize: "20px", 
            }, 500); 
            disableButtons(false)
            resetTimer()
      }
      else{
      document.getElementById('hour-2').textContent = Math.floor(hours / 10);
      document.getElementById('hour-1').textContent = hours % 10;
      document.getElementById('minute-2').textContent = Math.floor(minutes / 10);
      document.getElementById('minute-1').textContent = minutes % 10;
      document.getElementById('second-2').textContent = Math.floor(seconds / 10);
      document.getElementById('second-1').textContent = seconds % 10;
      }

      switch(totalSeconds){
        case 299: var audio = new Audio('/Audio/5-minutes.mp3');
                  audio.play();
                  break;
        case 119: var audio = new Audio('/Audio/2-minutes.mp3');
                  audio.play();
                  break;
        case 59: var audio = new Audio('/Audio/1-minute.mp3');
                  audio.play();
                  break;
        case 29: var audio = new Audio('/Audio/30-seconds.mp3');
                  audio.play();
                  break;
        case 10: var audio = new Audio('/Audio/10s.mp3');
                  audio.play();
                  break;
        case 9: var audio = new Audio('/Audio/9s.mp3');
                  audio.play();
                  break;
        case 8: var audio = new Audio('/Audio/8s.mp3');
                  audio.play();
                  break;
        case 7: var audio = new Audio('/Audio/7s.mp3');
                  audio.play();
                  break;
        case 6: var audio = new Audio('/Audio/6s.mp3');
                  audio.play();
                  break;
        case 5: var audio = new Audio('/Audio/5s.mp3');
                  audio.play();
                  break;
        case 4: var audio = new Audio('/Audio/4s.mp3');
                  audio.play();
                  break;
        case 3: var audio = new Audio('/Audio/3s.mp3');
                  audio.play();
                  break;
        case 2: var audio = new Audio('/Audio/2s.mp3');
                  audio.play();
                  break;
        case 1: var audio = new Audio('/Audio/1s.mp3');
                  audio.play();
                  break;
        default:break;
      }      
      myCallback();
    }

    const buttons = document.querySelectorAll('.increase, .decrease');
    let countdownInterval;

    $('.increase, .decrease').click(function() {
    const targetId = $(this).attr('data-target');
    const operation = $(this).hasClass('increase') ? 'increase' : 'decrease';
    
    const limit = (targetId === 'minute-2' || targetId === 'second-2') ? 5 : 9;
    updateNumber(targetId, operation, limit);
});


    document.getElementById('startButton').addEventListener('click', () => {
      disableButtons(true)
      clearInterval(countdownInterval);
      countdownInterval = setInterval(() => {
        updateClockWithCallback(() => {
          console.log('Callback from startButton click!');
        });
      }, 1000);
    });

    document.getElementById('stopButton').addEventListener('click', () => {
      disableButtons(false);
      clearInterval(countdownInterval);
    });

    document.getElementById('resetButton').addEventListener('click', () => {
      disableButtons(false);
      clearInterval(countdownInterval);
      resetTimer();
    });

    function resetTimer(){
      document.getElementById('hour-2').textContent = 0
      document.getElementById('hour-1').textContent = 0
      document.getElementById('minute-2').textContent = 0
      document.getElementById('minute-1').textContent = 0
      document.getElementById('second-2').textContent = 0
      document.getElementById('second-1').textContent = 0
      clearInterval(countdownInterval)
    }

    function validateInput() {
      var input = document.getElementById('exercise');
      var datalist = document.getElementById('exercises');
      var isValid = false;

      for (var i = 0; i < datalist.options.length; i++) {
        if (input.value === datalist.options[i].value) {
          isValid = true;
          break;
        }
      }

      if (!isValid) {
        input.setCustomValidity('Please choose a valid option from the list.');
      } else {
        input.setCustomValidity('');
      }
    }

    function updateList() {
      const selectedCategory = $('#exercise').val().toLowerCase();
      const listContainer = $('#exercise-list-container');
      console.log("asdf")

      // Clear previous lists
      // listContainer.html('');

      const exerciseData = {
        chest: ["Bench Press", "Push-ups", "Chest Flyes", "Dumbbell Press", "Incline Bench Press", "Cable Crossover"],
        back: ["Deadlifts", "Pull-ups", "Bent-over Rows", "Lat Pulldowns", "T-Bar Rows", "Face Pulls"],
        shoulder: ["Overhead Press", "Lateral Raises", "Front Raises", "Shrugs", "Upright Rows", "Arnold Press"],
        leg: ["Squats", "Lunges", "Deadlifts", "Leg Press", "Leg Extensions", "Calf Raises"],
        abdominal: ["Crunches", "Planks", "Leg Raises", "Russian Twists", "Bicycle Crunches", "Mountain Climbers"],
        arm: ["Bicep Curls", "Tricep Dips", "Hammer Curls", "Tricep Kickbacks", "Preacher Curls", "Skull Crushers"],
        "full-body": ["Burpees", "Clean and Jerk", "Thrusters", "Kettlebell Swings", "Turkish Get-ups", "Medicine Ball Slams"]
      };

      if (exerciseData[selectedCategory]) {
        listContainer.html('');
        const ul = $('<ul>').addClass('sortable-list').attr('id', selectedCategory + 'List');

        exerciseData[selectedCategory].forEach(exercise => {
          const li = $('<li>').addClass('item').attr('draggable', true).attr('data-video-id',exercise);
          const detailsDiv = $('<div>').addClass('details');
          const span = $('<span>').text(exercise);
          const dotsIcon = $('<i>').addClass('uil uil-draggabledots');

          detailsDiv.append(span);
          li.append(detailsDiv, dotsIcon);
          ul.append(li);
        });

        listContainer.append(ul);
        attachAgain();
      }
    }

    function removeFirstExerciseCallback() {
    console.log('Callback executed! First exercise removed.');
    } 

    document.getElementById('removeButton').addEventListener('click', () => {
    $('.sortable-list li:first-child').remove();
    removeFirstExerciseCallback();  // Invoke the callback function after removal
    });

    attachAgain();

  </script>

</body>
</html>
